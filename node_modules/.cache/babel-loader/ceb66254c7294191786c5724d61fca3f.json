{"ast":null,"code":"import _defineProperty from\"/Users/andrepetlovany/Desktop/GIT/elx/client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _regeneratorRuntime from\"/Users/andrepetlovany/Desktop/GIT/elx/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/andrepetlovany/Desktop/GIT/elx/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";var _extraReducers;import{createSlice,createAsyncThunk}from'@reduxjs/toolkit';import axios from'../../../utils/axios';var initialState={user:null,token:null,isLoading:false,status:null};export var registerUser=createAsyncThunk('auth/registerUser',/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref){var username,password,_yield$axios$post,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:username=_ref.username,password=_ref.password;_context.prev=1;_context.next=4;return axios.post('/auth/register',{username:username,password:password});case 4:_yield$axios$post=_context.sent;data=_yield$axios$post.data;if(data.token){window.localStorage.setItem('token',data.token);}return _context.abrupt(\"return\",data);case 10:_context.prev=10;_context.t0=_context[\"catch\"](1);console.log(_context.t0);case 13:case\"end\":return _context.stop();}}},_callee,null,[[1,10]]);}));return function(_x){return _ref2.apply(this,arguments);};}());export var loginUser=createAsyncThunk('auth/loginUser',/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(_ref3){var username,password,_yield$axios$post2,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:username=_ref3.username,password=_ref3.password;_context2.prev=1;_context2.next=4;return axios.post('/auth/login',{username:username,password:password});case 4:_yield$axios$post2=_context2.sent;data=_yield$axios$post2.data;if(data.token){window.localStorage.setItem('token',data.token);}return _context2.abrupt(\"return\",data);case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](1);console.log(_context2.t0);case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[1,10]]);}));return function(_x2){return _ref4.apply(this,arguments);};}());export var getMe=createAsyncThunk('auth/loginUser',/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var _yield$axios$get,data;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.get('/auth/me');case 3:_yield$axios$get=_context3.sent;data=_yield$axios$get.data;return _context3.abrupt(\"return\",data);case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0);case 11:case\"end\":return _context3.stop();}}},_callee3,null,[[0,8]]);})));export var authSlice=createSlice({name:'auth',initialState:initialState,reducers:{logout:function logout(state){state.user=null;state.token=null;state.isLoading=false;state.status=null;}},extraReducers:(_extraReducers={},_defineProperty(_extraReducers,registerUser.pending,function(state){state.isLoading=true;state.status=null;}),_defineProperty(_extraReducers,registerUser.fulfilled,function(state,action){state.isLoading=false;state.status=action.payload.message;state.user=action.payload.user;state.token=action.payload.token;}),_defineProperty(_extraReducers,registerUser.rejectWithValue,function(state,action){state.status=action.payload.message;state.isLoading=false;}),_defineProperty(_extraReducers,loginUser.pending,function(state){state.isLoading=true;state.status=null;}),_defineProperty(_extraReducers,loginUser.fulfilled,function(state,action){state.isLoading=false;state.status=action.payload.message;state.user=action.payload.user;state.token=action.payload.token;}),_defineProperty(_extraReducers,loginUser.rejectWithValue,function(state,action){state.status=action.payload.message;state.isLoading=false;}),_defineProperty(_extraReducers,getMe.pending,function(state){state.isLoading=true;state.status=null;}),_defineProperty(_extraReducers,getMe.fulfilled,function(state,action){var _action$payload,_action$payload2;state.isLoading=false;state.status=null;state.user=(_action$payload=action.payload)===null||_action$payload===void 0?void 0:_action$payload.user;state.token=(_action$payload2=action.payload)===null||_action$payload2===void 0?void 0:_action$payload2.token;}),_defineProperty(_extraReducers,getMe.rejectWithValue,function(state,action){state.status=action.payload.message;state.isLoading=false;}),_extraReducers)});export var checkIsAuth=function checkIsAuth(state){return Boolean(state.auth.token);};var logout=authSlice.actions.logout;export{logout};export default authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","initialState","user","token","isLoading","status","registerUser","username","password","post","data","window","localStorage","setItem","console","log","loginUser","getMe","get","authSlice","name","reducers","logout","state","extraReducers","pending","fulfilled","action","payload","message","rejectWithValue","checkIsAuth","Boolean","auth","actions","reducer"],"sources":["/Users/andrepetlovany/Desktop/GIT/elx/client/src/redux/features/auth/authSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit'\nimport axios from '../../../utils/axios'\n\nconst initialState = {\n    user: null,\n    token: null,\n    isLoading: false,\n    status: null,\n}\n\nexport const registerUser = createAsyncThunk(\n    'auth/registerUser',\n    async ({ username, password }) => {\n        try {\n            const { data } = await axios.post('/auth/register', {\n                username,\n                password,\n            })\n            if (data.token) {\n                window.localStorage.setItem('token', data.token)\n            }\n            return data\n        } catch (error) {\n            console.log(error)\n        }\n    },\n)\n\nexport const loginUser = createAsyncThunk(\n    'auth/loginUser',\n    async ({ username, password }) => {\n        try {\n            const { data } = await axios.post('/auth/login', {\n                username,\n                password,\n            })\n            if (data.token) {\n                window.localStorage.setItem('token', data.token)\n            }\n            return data\n        } catch (error) {\n            console.log(error)\n        }\n    },\n)\n\nexport const getMe = createAsyncThunk('auth/loginUser', async () => {\n    try {\n        const { data } = await axios.get('/auth/me')\n        return data\n    } catch (error) {\n        console.log(error)\n    }\n})\n\n\nexport const authSlice = createSlice({\n    name: 'auth',\n    initialState,\n    reducers: {\n        logout: (state) => {\n            state.user = null\n            state.token = null\n            state.isLoading = false\n            state.status = null\n        },\n    },\n    extraReducers: {\n        // Register user\n        [registerUser.pending]: (state) => {\n            state.isLoading = true\n            state.status = null\n        },\n        [registerUser.fulfilled]: (state, action) => {\n            state.isLoading = false\n            state.status = action.payload.message\n            state.user = action.payload.user\n            state.token = action.payload.token\n        },\n        [registerUser.rejectWithValue]: (state, action) => {\n            state.status = action.payload.message\n            state.isLoading = false\n        },\n        // Login user\n        [loginUser.pending]: (state) => {\n            state.isLoading = true\n            state.status = null\n        },\n        [loginUser.fulfilled]: (state, action) => {\n            state.isLoading = false\n            state.status = action.payload.message\n            state.user = action.payload.user\n            state.token = action.payload.token\n        },\n        [loginUser.rejectWithValue]: (state, action) => {\n            state.status = action.payload.message\n            state.isLoading = false\n        },\n        // Проверка авторизации\n        [getMe.pending]: (state) => {\n            state.isLoading = true\n            state.status = null\n        },\n        [getMe.fulfilled]: (state, action) => {\n            state.isLoading = false\n            state.status = null\n            state.user = action.payload?.user\n            state.token = action.payload?.token\n        },\n        [getMe.rejectWithValue]: (state, action) => {\n            state.status = action.payload.message\n            state.isLoading = false\n        },\n    },\n})\n\nexport const checkIsAuth = (state) => Boolean(state.auth.token)\n\nexport const { logout } = authSlice.actions\nexport default authSlice.reducer"],"mappings":"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"},"metadata":{},"sourceType":"module"}